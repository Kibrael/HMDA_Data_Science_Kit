DROP TABLE IF EXISTS mlar_2019_{lei};
CREATE TABLE mlar_2019_{lei} (  
    record_id NUMERIC,
    lei VARCHAR,
    loan_type NUMERIC, 
    loan_purpose NUMERIC,
    preapproval NUMERIC,
    construction_method NUMERIC,
    occupancy_type NUMERIC,
    loan_amount NUMERIC,
    action_taken NUMERIC,
    state VARCHAR,
    county VARCHAR,
    census_tract VARCHAR,
    applicant_ethnicity_1 VARCHAR,
    applicant_ethnicity_2 VARCHAR,
    applicant_ethnicity_3 VARCHAR,
    applicant_ethnicity_4 VARCHAR,
    applicant_ethnicity_5 VARCHAR,
    co_applicant_ethnicity_1 VARCHAR,
    co_applicant_ethnicity_2 VARCHAR,
    co_applicant_ethnicity_3 VARCHAR,
    co_applicant_ethnicity_4 VARCHAR,
    co_applicant_ethnicity_5 VARCHAR,
    applicant_ethnicity_basis NUMERIC,
    co_applicant_ethnicity_basis NUMERIC,
    applicant_race_1 VARCHAR,
    applicant_race_2 VARCHAR,
    applicant_race_3 VARCHAR,
    applicant_race_4 VARCHAR,
    applicant_race_5 VARCHAR,
    co_applicant_race_1 VARCHAR,
    co_applicant_race_2 VARCHAR,
    co_applicant_race_3 VARCHAR,
    co_applicant_race_4 VARCHAR,
    co_applicant_race_5 VARCHAR,
    applicant_race_basis NUMERIC,
    co_applicant_race_basis NUMERIC,
    applicant_sex NUMERIC,
    co_applicant_sex NUMERIC,
    applicant_sex_basis NUMERIC,
    co_applicant_sex_basis NUMERIC,
    applicant_age VARCHAR,
    applicant_greater_equal_62 VARCHAR,
    co_applicant_age VARCHAR,
    co_applicant_greater_equal_62 VARCHAR,
    income VARCHAR,    
    purchaser_type NUMERIC,
    rate_spread VARCHAR,
    hoepa_status NUMERIC,
    lien_status NUMERIC,
    applicant_score_model NUMERIC,
    co_applicant_score_model NUMERIC,
    denial_1 NUMERIC,
    denial_2 VARCHAR,
    denial_3 VARCHAR,
    denial_4 VARCHAR,
    total_loan_costs VARCHAR,
    total_points_fees VARCHAR,
    origination_charges VARCHAR,
    discount_points VARCHAR, 
    lender_credits VARCHAR,
    interest_rate VARCHAR,
    prepayment_penalty_term VARCHAR,
    dti VARCHAR,
    cltv VARCHAR,
    loan_term VARCHAR,
    introductory_rate_period VARCHAR,
    balloon_payment NUMERIC,
    interest_only_payments NUMERIC, 
    negative_amort NUMERIC,
    other_non_amort NUMERIC,
    property_value VARCHAR,
    manufactured_home_prop_type NUMERIC,
    manufactured_land_prop_interest NUMERIC,
    total_units VARCHAR,
    multifamily_affordable_units VARCHAR,
    submission_of_application NUMERIC,
    initially_payable NUMERIC,
    aus_1 NUMERIC,
    aus_2 VARCHAR,
    aus_3 VARCHAR,
    aus_4 VARCHAR,
    aus_5 VARCHAR,
    reverse_mortgage NUMERIC,
    open_end_credit NUMERIC,
    business_or_commercial_purpose NUMERIC);

COPY hmda_public.mlar_2019_{lei}
FROM '{data_path}/data/mlar/2019/{lei}.txt'
DELIMITER '|' ENCODING 'latin1';
COMMIT;
